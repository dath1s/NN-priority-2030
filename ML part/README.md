## Обнаружение и отслеживание объектов с использованием OpenCV и YOLOv8

Этот проект демонстрирует, как использовать OpenCV для отслеживания объектов с помощью модели для обнаружения объектов YOLOv8. YOLO (You Only Look Once) — это эффективная и популярная модель для обнаружения объектов в изображениях и видео.

### Установка необходимых библиотек

Для начала убедитесь, что у вас установлены следующие библиотеки:

```bash
pip install opencv-python opencv-python-headless numpy torch torchvision opencv-contrib-python
```

## Пример использования
Ниже представлен пример кода, который выполняет обнаружение объектов с помощью YOLOv8 и отслеживает их с использованием OpenCV.

```python
import cv2
import numpy as np
import torch

# Загрузка модели YOLOv8
model = torch.hub.load('ultralytics/yolov5', 'yolov8n.pt')

# Функция для отслеживания объектов
def track_objects(video_path):
    # Инициализация видео
    cap = cv2.VideoCapture(video_path)

    # Обработка первого кадра
    ret, frame = cap.read()
    if not ret:
        print("Не удалось прочитать видео.")
        return

    # Инициализация трекера
    tracker = cv2.legacy.TrackerCSRT_create()

    # Обнаружение объектов на первом кадре
    results = model(frame)
    boxes = results.xyxy[0].numpy()  # Извлечение координат рамки
    if len(boxes) > 0:
        # Используем первую обнаруженную рамку для отслеживания
        x1, y1, x2, y2 = boxes[0][:4]
        bbox = (x1, y1, x2 - x1, y2 - y1)  # Формат: (x, y, w, h)
        tracker.init(frame, bbox)

    while cap.isOpened():
        ret, frame = cap.read()
        if not ret:
            break

        # Обновление трекера
        success, bbox = tracker.update(frame)

        if success:
            x, y, w, h = [int(v) for v in bbox]
            cv2.rectangle(frame, (x, y), (x + w, y + h), (0, 255, 0), 2)

        # Отображение результата
        cv2.imshow('Object Tracking', frame)

        if cv2.waitKey(1) & 0xFF == ord('q'):
            break

    cap.release()
    cv2.destroyAllWindows()

# Запуск отслеживания объектов
track_objects('path_to_your_video.mp4')
```

## Параметры функции
- `video_path`: Путь к видеофайлу, в котором вы хотите отслеживать объекты.

## Примечания
- Данный код использует трекер CSRT, который является хорошим выбором для большинства сценариев отслеживания. Однако OpenCV также предоставляет другие трекеры (например, KCF, MIL, BOOSTING и т.д.), которые могут быть использованы в зависимости от конкретных требований.

- ## Описание CSRT Tracker

Tracker CSRT (Discriminative Correlation Filter with Channel and Spatial Reliability) является одним из трекеров, предоставляемых OpenCV, который используется для отслеживания объектов в видеопоследовательности. Этот трекер основан на корреляционных фильтрах и обладает хорошими свойствами, такими как устойчивость к изменениям масштаба и деформации объектов.

## Основные особенности

1. **Надежность пространств и каналов**: Tracker CSRT использует пространственные и канализационные параметры, чтобы повысить качество отслеживания. Это позволяет фильтру оставаться стабильным даже при изменениях в форме и размере объектов.

2. **Адаптивность**: У этого трекера есть возможность адаптироваться к изменениям во внешнем виде объекта, что делает его полезным для динамических сцен.

3. **Устойчивость к шуму**: CSRT имеет встроенные механизмы для подавления шумов, что позволяет ему работать в сложных условиях.

## Параметры и настройки
Tracker CSRT имеет различные параметры и настройки, которые могут быть отрегулированы для улучшения производительности:

- `use_hog`: Использование HOG (Histogram of Oriented Gradients) для улучшения обнаружения объектов. По умолчанию True.

- `use_color_names`: Использование цветовых имен для инициализации более надежного трекера. По умолчанию True.

- `num_hog_channels`: Число HOG-каналов для использования.

Чтобы установить эти параметры, используйте следующий код:

```python
tracker = cv2.legacy.TrackerCSRT_create()
# Установка параметров
tracker.setParameters({
    'use_hog': True,
    'use_color_names': True,
    'num_hog_channels': 2,
})
```
